# AlignJuice 百科数据实战配置
# 简化版：不使用 LLM 合成，验证基础流程

name: baike_demo
version: "1.0.0"

# 全局设置
checkpoint_enabled: true
checkpoint_dir: .checkpoints/baike
parallel_workers: 4

# 数据格式
input_format: jsonl
output_format: jsonl

# 阈值设置
dedup_threshold: 0.95
quality_threshold: 0.7
target_samples: 1000

# 嵌入配置 (用于语义去重和知识评分)
embedding:
  backend: sentence_transformers
  model: all-MiniLM-L6-v2
  batch_size: 64

# 流水线阶段
stages:
  # Stage 1: 去重 + 质量过滤
  - name: s1_data_juicer
    operators:
      - name: exact_dedup
        enabled: true
        params:
          field: instruction

      - name: semantic_dedup
        enabled: true
        params:
          threshold: 0.95
          field: instruction

      - name: quality_filter
        enabled: true
        params:
          threshold: 0.7
          min_instruction_length: 5
          min_output_length: 10

      - name: diversity_filter
        enabled: true
        params:
          target_count: 1500
          selection_method: maxmin

  # Stage 2: 知识密度筛选 (不使用 LLM 合成)
  - name: s2_knowledge_filter
    operators:
      - name: knowledge_filter
        enabled: true
        params:
          top_k: 1000

  # Stage 4: 评估报告
  - name: s4_sandbox_eval
    operators: []
